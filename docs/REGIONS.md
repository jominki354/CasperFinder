# 캐스퍼 기획전 배송지역 / 보조금 지역 코드 분석

> **목적**: 각 기획전별 배송지역 설정 기능 구현을 위한 기준 문서
> **데이터 소스**: `constants/regions.json` (브라우저 Vue 컴포넌트에서 직접 추출)
> **추출일**: 2026-02-10

---

## 1. 개요

캐스퍼 기획전 페이지에서 차량 목록 API(`getProductList`)를 호출할 때, **2종류의 지역 코드**가 필요합니다.

| 구분 | 파라미터명 | 코드 형식 | 역할 |
|:---|:---|:---|:---|
| **배송 권역 (시/도)** | `deliveryAreaCode` | 알파벳 1자 (`B`, `D`, `E`…) | 출고센터 → 배송지 기준 배송비 산정 |
| **배송 상세 (시/군/구)** | `deliveryLocalAreaCode` | 알파벳+숫자 (`B0`, `EC`…) | 시/군/구 단위 세분화 |
| **보조금 시/도** | (내부 코드) | 숫자 2자리 (`01`, `07`…) | 전기차 보조금 지역 그룹 |
| **보조금 지역** | `subsidyRegion` | 숫자 4자리 (`1100`, `4111`…) | 지자체별 보조금 적용 (실구매가 결정) |

---

## 2. 배송 지역 (Delivery Regions)

### 2.1 시/도 코드 매핑

| 시/도 | `deliveryAreaCode` | 비고 |
|:---|:---:|:---|
| 서울 | `B` | 단일 지역 (`B0`) |
| 인천 | `D` | 강화군·영종도 분리 |
| 경기 | `E` | **31개** 시/군 (가장 많음) |
| 강원 | `F` | 18개 시/군 |
| 세종 | `W` | 단일 (`I9`) — 충남(`I`) 코드 체계 공유 |
| 충남 | `I` | 15개 시/군 |
| 대전 | `H` | 단일 (`H0`) |
| 충북 | `G` | 11개 시/군 |
| 대구 | `M` | 군위군 포함 (`M1`) |
| 경북 | `N` | 22개 시/군 |
| 부산 | `P` | 단일 (`P0`) |
| 경남 | `S` | 20개 시/군 (진해구·해인사 별도 코드) |
| 울산 | `U` | 울주군 분리 (`U1`) |
| 전북 | `J` | 14개 시/군 |
| 전남 | `L` | 22개 시/군 |
| 광주 | `K` | 단일 (`K0`) |
| 제주 | `T` | 제주시(`T1`) / 서귀포시(`T2`) |

### 2.2 특이사항
* **세종시** 코드가 `W`이지만, 하위 코드는 `I9`로 충남(`I`) 체계를 공유합니다.
* **경남 경창원 지역**은 `진해구(창원)` (`SC`)와 `해인사(합천)` (`SK`)가 별도 코드로 분리되어 있습니다.
* 광역시(서울, 부산, 대전, 광주)는 하위 구 단위 구분 없이 **단일 코드**입니다.

---

## 3. 전기차 보조금 지역 (Subsidy Regions)

### 3.1 시/도 코드 매핑

| 시/도 | 보조금 시/도 코드 | 대표 `subsidyRegion` |
|:---|:---:|:---:|
| 서울 | `01` | `1100` |
| 강원 | `02` | `4211` (춘천) |
| 대전 | `03` | `3000` |
| 충북 | `04` | `4311` (청주) |
| 충남 | `05` | `4413` (천안) |
| 인천 | `06` | `2800` |
| 경기 | `07` | `4111` (수원) |
| 광주 | `08` | `2900` |
| 전북 | `09` | `4511` (전주) |
| 전남 | `10` | `4611` (목포) |
| 부산 | `11` | `2600` |
| 울산 | `12` | `3100` |
| 경남 | `13` | `4812` (창원) |
| 제주 | `14` | `5000` |
| 대구 | `15` | `2700` |
| 경북 | `16` | `4711` (포항) |
| 세종 | `17` | `3611` |
| 한국환경공단 | `99` | `9999` |

### 3.2 특이사항
* 광역시/특별시는 하위 구 단위 없이 **단일 코드**입니다.
* **한국환경공단** (`99` / `9999`)은 특수 용도 (보조금 미적용 또는 공단 직접 관리) 코드입니다.
* 보조금 코드는 **행정안전부 법정동 코드 체계**와 유사합니다 (앞 2자리가 시/도).

---

## 4. API Payload 매핑

배송 지역을 변경하면 기획전 API 호출 시 아래 필드가 변경됩니다:

```json
{
  "deliveryAreaCode": "B",       // 배송 시/도 (알파벳)
  "deliveryLocalAreaCode": "B0", // 배송 시/군/구
  "subsidyRegion": "1100"        // 보조금 지역 (숫자 4자리)
}
```

### 4.1 변경 프로세스 (브라우저 기준)
1. 사용자가 "배송지역 변경" 클릭 → 모달 오픈
2. **배송지 변경**: 시/도 선택 → 시/군/구 선택
3. **보조금 지역**: 시/도 선택 → 시/군 선택
4. "변경" 버튼 클릭
5. 선택값이 **쿠키/세션**에 저장됨
6. 이후 `getProductList` API 호출 시 payload에 자동 포함

### 4.2 쿠키 구조 (참고)
```
regionData={"regionSidoCode":"01","regionCode":"1100","regionName":"서울특별시"}
siDoData={"siDoCode":"B","siDoName":"서울"}
siGunData={"siGunCode":"B0","siGunName":"서울특별시"}
```

---

## 5. 구현 가이드

### 5.1 앱 설정 UI (`ui/app.py`)
```
[배송 지역 설정]
  시/도: [서울 ▼]  시/군/구: [서울특별시 ▼]

[보조금 지역 설정]
  시/도: [서울 ▼]  시/군:   [서울특별시 ▼]
```
* `constants/regions.json`을 로드하여 콤보박스 옵션 생성
* 시/도 선택 시 하위 시/군/구 옵션을 동적 필터링

### 5.2 전국 검색 모드
모든 `deliveryAreaCode`(`B`, `D`, `E`, …, `T`)를 순회하며 API 호출하면 **전국 매물**을 전수 조사할 수 있습니다.

```python
ALL_DELIVERY_CODES = ["B","D","E","F","W","I","H","G","M","N","P","S","U","J","L","K","T"]
for code in ALL_DELIVERY_CODES:
    payload["deliveryAreaCode"] = code
    payload["deliveryLocalAreaCode"] = get_first_sigun(code)
    results += await fetch_vehicles(payload)
```

### 5.3 기획전별 독립 설정
각 기획전(E, D, R, W)마다 **독립적으로** 배송 지역을 설정할 수 있도록 config 구조를 확장합니다:

```json
{
  "targets": [
    {
      "exhbNo": "E20260223",
      "label": "특별기획전",
      "deliveryAreaCode": "B",
      "deliveryLocalAreaCode": "B0",
      "subsidyRegion": "1100"
    },
    {
      "exhbNo": "D0003",
      "label": "전시차",
      "deliveryAreaCode": "E",
      "deliveryLocalAreaCode": "EC",
      "subsidyRegion": "4111"
    }
  ]
}
```

---

## 6. 데이터 파일 위치

| 파일 | 설명 |
|:---|:---|
| `constants/regions.json` | 전체 배송/보조금 지역 코드 (JSON) |
| `docs/REGIONS.md` | 이 문서 (분석 및 구현 가이드) |
